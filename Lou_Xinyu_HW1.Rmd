---
title: "Intro. enginyeria financera - HW1"
author:
- Lou, Xinyu ()
- Tarrag√≥ Boardman, Oliver ()
date: "Last compiled on `r format(Sys.time(), '%d/%m/%Y')`"
---

1. Run the following code corresponding three quarterly time series data and answer the questions below.\

```{r, eval=FALSE}
data(Tbrate , package = " Ecdat ")
library(tseries)
# r = the 91 - day treasury bill rate
# y = the log of real GDP
# pi = the inflation rate

# Questions a ) and b )
plot(Tbrate)
acf(Tbrate)
# Consider only the diagonal plots which correspond to the ACF plots of r , y and pi
adf.test(Tbrate [, 1])
adf.test(Tbrate [, 2])
adf.test(Tbrate [, 3])

# Qeustions c ) and d )
diff_rate = diff (Tbrate)
adf.test(diff_rate [, 1])
adf.test(diff_rate [, 2])
adf.test(diff_rate [, 3])
plot(diff_rate)
acf(diff_rate)

# Questions e ) , f ) , g ) and h )
library (forecast)
auto.arima (Tbrate [, 1] ,
            max.P = 0 ,
            max.Q = 0 ,
            ic = " aic")

# Questions i )
fit1 = arima(Tbrate [, 1], order = c(?,?,?))
acf(residuals(fit1))
Box.test(residuals(fit1), lag = 10, type = " Ljung ") 
```
    
  a) Describe the signs of nonstationarity seen in the time series and ACF plots.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
data(Tbrate, package="Ecdat")
library(tseries)
```

```{r}
plot(Tbrate)
acf(Tbrate)
# Consider only the diagonal plots which correspond to the ACF plots of r , y and pi
```

Both the plot and the ACF show that neither of the tree variables is non-stationary. The plot of each variable seems to have a tendency, maybe the pi is less clear. The ACF plot for each variable shows a steady decay of the correlation each lag, which means the is non-stationary.

  b) Use the augmented Dickey-Fuller tests to decide which of the series are nonstationary (search on R help for the definition of the test and what conclusions shows). Do the tests corroborate the conclusions of the time series ACF plots?
  
```{r}
print(adf.test(Tbrate[, 1]))
print(adf.test(Tbrate[, 2]))
print(adf.test(Tbrate[, 3]))
```

The null hypothesis of the Dickey-Fuller test is that the time series is non-stationary. Since for each variable the p-value is much higher than 0.05, we do not reject the null hypothesis, so the time series are non-stationary.

  c) Do the difference series appear stationary according to the augmented Dickey-Fuller test?
  
```{r}
diff_rate = diff(Tbrate)
print(adf.test(diff_rate[, 1]))
print(adf.test(diff_rate[, 2]))
print(adf.test(diff_rate[, 3]))
plot(diff_rate)
acf(diff_rate)
```

All the Dickey-Fuller tests, the plots and the ACFs show that the difference series appear stationary.

  d) Do you see evidence of autocorrelation in the differentiated series? If so, describe these correlations.
  
We see evidence of autocorrelation in the differentiated series. Both for de _r_ and _y_ variables we see a positive correlation with the first lag, and for the _pi_ variable we see a negative correlation with the first lag.

  e) What order of differentiation is chosen in auto.arima? Does this result agree with your previous conclusions?
  
```{r}
library (forecast)
print(auto.arima (Tbrate[, 1], ic = "aic"))
```

The function _auto.arima_ has chosen one order of differentiation (d=1). This result agrees with our previous calculation.

  f) What model was chosen by AIC?

The _auto.arima_ function, using the AIC criteria, chosen the model **ARIMA(0,1,1)**, that is a **MA(1)** model over the one time differentiated series.

  g) Which goodness-of-fit criterion is being used here?

The AIC criterion, which uses the log likelihood criterion.

  h) Change the criterion to BIC. Does the best-fitting model then change?
  
```{r}
print(auto.arima (Tbrate[, 1], ic = "bic"))
```

Using the BIC criterion, _auto.arima_ has chosen the same model than using the AIC criterion.

  i) Do you think that there is residual autocorrelation? If so, describe this autocorrelation and suggest a mode appropriate model for the T-bill series.
  

```{r}
fit1 = arima(Tbrate [, 1], order = c(0,1,1))
acf(residuals(fit1))
Box.test(residuals(fit1), lag = 10, type = "Ljung-Box") 
```

The ACF plot of the residuals shows no autocorrelation. The null hypothesis of the Ljung-Box test is that the residuals are independent, since the p-value is higher than 0.05 we have no statistical evidence to reject the null hypothesis, hence we can conclude that the residuals have no correlation.

